@runtime
Feature: testsuite uploads

  Background: 
    * url appUrl
    * def JavaClass = Java.type('data.HashMap')
    * def JWTToken = JavaClass.get('JWTToken')
    * def JavaMethods = Java.type('data.commonJava')
    * def JWTTokenSecondAccount = JavaClass.get('JWTTokenSecondAccount')
    * def name = JavaMethods.generateRandom('number')
    * def SanitystreamId2 = JavaClass.get('SanityStreamId2')
    * def SanitystreamId1 = JavaClass.get('SanityStreamId1')
    * print JWTTokenSecondAccount
    * print JWTToken
    * print SanitystreamId2
    * print SanitystreamId1

  Scenario: BotDefinition File upload using FirstUserAccount Token
    Given url publicUrl
    * def file = '/public/uploadfile'
    Given path file
    And header Content-Type = 'multipart/form-data'
    And header auth = JWTToken
    And multipart file file = { read: 'test12.csv', filename: 'test12.csv', contentType: 'test12.csv' }
    And multipart field fileContext = 'bulkImport'
    And multipart field fileExtension = 'json'
    When method post
    Then status 200
    * def FileID = response.fileId
    * JavaClass.add('FileID', FileID)
    * print FileID

  Scenario: 1Positive Scenario -----------> Import TestSuite in the Bot owned by FirstUserAccount with same jwt token and same Fileid
    * def SanitystreamId1 = JavaClass.get('SanityStreamId1')
    * print SanitystreamId1
    * def FileID = JavaClass.get('FileID')
    * def Payload = read('Batchtesting1.json')
    * set Payload.fileName = FileID
    Given url publicUrl
    Then path '/public/stream/'+SanitystreamId1+'/testsuite/import'
    And request Payload
    And header auth = JWTToken
    And header Content-Type = 'application/json'
    When method post
    Then status 200
    And print 'Response is: ', response
    * def batchtestId = response.requestId
    * JavaClass.add('batchtestId',batchtestId)

  Scenario: BotDefinition File upload using SecondUserAccount Token
    Given url publicUrl
    * def file = '/public/uploadfile'
    Given path file
    And header Content-Type = 'multipart/form-data'
    And header auth = JWTTokenSecondAccount
    And multipart file file = { read: 'test12.csv', filename: 'test12.csv', contentType: 'test12.csv' }
    And multipart field fileContext = 'bulkImport'
    And multipart field fileExtension = 'json'
    When method post
    Then status 200
    * def FileID2 = response.fileId
    * JavaClass.add('FileID2', FileID2)
    * print FileID2

  Scenario: 2Positive Scenario -----------> Import TestSuite in the Bot owned by SecondUserAccount with same jwt token and same Fileid
    * def SanitystreamId2 = JavaClass.get('SanityStreamId2')
    * def FileID2 = JavaClass.get('FileID2')
    * def Payload = read('Batchtesting2.json')
    * set Payload.fileName = FileID2
    Given url publicUrl
    Then path '/public/stream/'+SanitystreamId2+'/testsuite/import'
    And request Payload
    And header auth = JWTTokenSecondAccount
    And header Content-Type = 'application/json'
    When method post
    Then status 200
    And print 'Response is: ', response
    * def batchtestId2 = response.requestId
    * JavaClass.add('batchtestId2',batchtestId2)

  Scenario: 3Positive Scenario -----------> Import TestSuite in Bot owned By Second User Account  with  fileid Generated by Second User Account and jwt Geneated By  FirstUseraccount
    * def SanitystreamId2 = JavaClass.get('SanityStreamId2')
    * def FileID2 = JavaClass.get('FileID')
    * def Payload = read('Batchtesting3.json')
    * set Payload.fileName = FileID2
    Given url publicUrl
    Then path '/public/stream/'+SanitystreamId2+'/testsuite/import'
    And request Payload
    And header auth = JWTToken
    And header Content-Type = 'application/json'
    When method post
    Then status 200
    And print 'Response is: ', response
    * def batchtestId3 = response.requestId
    * JavaClass.add('batchtestId3',batchtestId3)

  Scenario: 4Positive Scenario -----------> Import TestSuite in Bot owned By FirstUser Account with FileId genertaed By First User Account and Jwt Generated By Second Account
    * def SanitystreamId1 = JavaClass.get('SanityStreamId1')
    * def FileID = JavaClass.get('FileID')
    * def Payload = read('Batchtesting4.json')
    * set Payload.fileName = FileID
    Given url publicUrl
    Then path '/public/stream/'+SanitystreamId1+'/testsuite/import'
    And request Payload
    And header auth = JWTTokenSecondAccount
    And header Content-Type = 'application/json'
    When method post
    Then status 200
    And print 'Response is: ', response
    * def batchtestId4 = response.requestId
    * JavaClass.add('batchtestId4',batchtestId4)

  Scenario: 5Positive Scenario -----------> Import TestSuite in Bot owned By FirstUser Account with FileId genertaed By First User Account and Jwt Generated By Second Account
    * def SanitystreamId1 = JavaClass.get('SanityStreamId1')
    * def FileID = JavaClass.get('FileID')
    * def Payload = read('Batchtesting5.json')
    * set Payload.fileName = FileID
    Given url publicUrl
    Then path '/public/stream/'+SanitystreamId1+'/testsuite/import'
    And request Payload
    And header auth = JWTTokenSecondAccount
    And header Content-Type = 'application/json'
    When method post
    Then status 200
    And print 'Response is: ', response
    * def batchtestId4 = response.requestId
    * JavaClass.add('batchtestId4',batchtestId4)

  Scenario: 6Positive Scenario -----------> Import TestSuite in Bot owned By FirstUser Account with FileId genertaed By Second User Account and Jwt Generated By Second Account
    * def SanitystreamId1 = JavaClass.get('SanityStreamId1')
    * def FileID2 = JavaClass.get('FileID')
    * def Payload = read('Batchtesting6.json')
    * set Payload.fileName = FileID2
    Given url publicUrl
    Then path '/public/stream/'+SanitystreamId1+'/testsuite/import'
    And request Payload
    And header auth = JWTTokenSecondAccount
    And header Content-Type = 'application/json'
    When method post
    Then status 200
    And print 'Response is: ', response
    * def batchtestId6 = response._id
    * JavaClass.add('batchtestId6',batchtestId6)
    * print batchtestId6
    * def batchtestId6 = JavaClass.get('batchtestId6')
    And match response._id contains batchtestId6

  Scenario: 7Positive Scenario -----------> Import TestSuite in Bot owned By Second Account with FileId genertaed By first User Account and Jwt Generated By first Account
    * def SanitystreamId2 = JavaClass.get('SanityStreamId2')
    * def FileID = JavaClass.get('FileID')
    * def Payload = read('Batchtesting7.json')
    * set Payload.fileName = FileID
    Given url publicUrl
    Then path '/public/stream/'+SanitystreamId2+'/testsuite/import'
    And request Payload
    And header auth = JWTTokenSecondAccount
    And header Content-Type = 'application/json'
    When method post
    Then status 200
    And print 'Response is: ', response
    * def batchtestId7 = response._id
    * JavaClass.add('batchtestId7',batchtestId7)
    * print batchtestId7
    * def batchtestId7 = JavaClass.get('batchtestId7')
